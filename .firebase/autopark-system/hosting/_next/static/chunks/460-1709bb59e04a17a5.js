"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[460],{868:(e,s,t)=>{t.d(s,{A:()=>n});var r=t(5155);let l={success:"bg-green-100 text-green-800",info:"bg-blue-100 text-blue-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800"},a={success:"bg-green-500",info:"bg-blue-500",warning:"bg-yellow-500",danger:"bg-red-500"},i={sm:"px-2.5 py-0.5 text-xs",md:"px-3 py-1 text-sm"},n=e=>{let{status:s,variant:t,size:n="md",showDot:c=!1}=e;return(0,r.jsxs)("span",{className:"inline-flex items-center gap-2 font-medium rounded-full ".concat(i[n]," ").concat(l[t]),children:[c&&(0,r.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(a[t])}),s]})}},926:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0}),!function(e,s){for(var t in s)Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}(s,{callServer:function(){return r.callServer},createServerReference:function(){return a.createServerReference},findSourceMapURL:function(){return l.findSourceMapURL}});let r=t(1209),l=t(5153),a=t(7197)},983:(e,s,t)=>{t.d(s,{A:()=>i});var r=t(5155);let l={blue:"bg-blue-500",green:"bg-green-500",purple:"bg-purple-500",orange:"bg-orange-500",red:"bg-red-500"},a={up:"text-green-400",down:"text-red-400",neutral:"text-gray-400"},i=e=>{let{title:s,value:t,change:i,trend:n="neutral",icon:c,color:d="blue",description:o}=e;return(0,r.jsxs)("div",{className:"relative overflow-hidden rounded-2xl bg-white shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 group",children:[(0,r.jsx)("div",{className:"absolute inset-0 ".concat(l[d]," opacity-5 group-hover:opacity-10 transition-opacity")}),(0,r.jsxs)("div",{className:"relative p-6",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600 mb-1",children:s}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900 mb-2",children:t}),o&&(0,r.jsx)("p",{className:"text-xs text-gray-500",children:o})]}),(0,r.jsx)("div",{className:"p-3 rounded-xl ".concat(l[d]," text-white shadow-lg"),children:c})]}),i&&(0,r.jsxs)("div",{className:"flex items-center mt-4 pt-4 border-t border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center text-sm font-medium ".concat(a[n]),children:["up"===n&&(0,r.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),"down"===n&&(0,r.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M14.707 10.293a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 111.414-1.414L9 12.586V5a1 1 0 012 0v7.586l2.293-2.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),i]}),(0,r.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"за последний месяц"})]})]})]})}},3545:(e,s,t)=>{t.r(s),t.d(s,{default:()=>v});var r=t(5155),l=t(2115),a=t(9934),i=t(9708);function n(e){let{active:s,routeId:t}=e,{auth:n,firestore:c}=(0,a.D)(),[d,o]=(0,l.useState)(null),[x,m]=(0,l.useState)(null),[u,g]=(0,l.useState)("idle"),h=(0,l.useRef)(0),j=(0,l.useRef)(null);return(0,l.useEffect)(()=>{if(!s){g("idle"),null!==j.current&&(navigator.geolocation.clearWatch(j.current),j.current=null);return}if(!("geolocation"in navigator))return void m("Геолокация не поддерживается этим браузером.");g("requesting");try{var e;"permissions"in navigator&&(null==(e=navigator.permissions)?void 0:e.query)&&navigator.permissions.query({name:"geolocation"}).then(e=>{"denied"===e.state&&m("Доступ к геолокации запрещён. Разрешите доступ в настройках браузера.")}).catch(()=>{})}catch(e){}let r=async e=>{let{latitude:s,longitude:r}=e.coords;o({latitude:s,longitude:r}),g("watching");let l=Date.now(),a=h.current;if(!n.currentUser||l-a<1e4)return;h.current=l;let d=n.currentUser.uid,x={latitude:s,longitude:r,timestamp:(0,i.O5)()};if(await (0,i.BN)((0,i.H9)(c,"users",d,"location","current"),x,{merge:!0}).catch(()=>{}),t){await (0,i.BN)((0,i.H9)(c,"routes",d),{activeRouteId:t,lastLocation:x},{merge:!0}).catch(()=>{});let e=(0,i.rJ)(c,"routes",d,"track"),s=String(l);await (0,i.BN)((0,i.H9)(e,s),{...x,routeId:t}).catch(()=>{})}};return j.current=navigator.geolocation.watchPosition(r,e=>{e.code===e.PERMISSION_DENIED?m("Доступ к геолокации отклонён. Разрешите доступ, затем обновите страницу."):e.code===e.POSITION_UNAVAILABLE?m("Позиция недоступна. Проверьте GPS/сеть и попробуйте снова."):e.code===e.TIMEOUT?m("Не удалось получить координаты: таймаут."):m(e.message),g("idle")},{enableHighAccuracy:!0,timeout:8e3,maximumAge:5e3}),()=>{null!==j.current&&(navigator.geolocation.clearWatch(j.current),j.current=null)}},[s,t,n,c]),(0,r.jsx)("div",{className:"w-full",children:d?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-green-500 rounded-full flex items-center justify-center shadow-lg",children:(0,r.jsxs)("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),(0,r.jsx)("div",{className:"absolute -top-1 -right-1 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",children:(0,r.jsx)("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"})})]})}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Местоположение отслеживается"}),(0,r.jsx)("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"Широта:"}),(0,r.jsx)("p",{className:"font-mono font-medium text-gray-900",children:d.latitude.toFixed(6)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500",children:"Долгота:"}),(0,r.jsx)("p",{className:"font-mono font-medium text-gray-900",children:d.longitude.toFixed(6)})]})]})}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Обновляется каждые 10 секунд"})]})]}):(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:"requesting"===u?(0,r.jsx)("div",{className:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}):(0,r.jsxs)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:x?"Ошибка геолокации":"requesting"===u?"Получение местоположения...":"Ожидание старта маршрута"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:x||("requesting"===u?"Запрашиваем доступ к геолокации":'Нажмите "Начать смену" для активации отслеживания')})]})})}var c=t(868),d=t(898);let o={pending:{variant:"warning",label:"Ожидает",color:"yellow"},in_progress:{variant:"info",label:"В процессе",color:"blue"},completed:{variant:"success",label:"Завершено",color:"green"}},x={low:{color:"text-green-600",bg:"bg-green-100",label:"Низкий"},medium:{color:"text-yellow-600",bg:"bg-yellow-100",label:"Средний"},high:{color:"text-red-600",bg:"bg-red-100",label:"Высокий"}},m=e=>{let{task:s,onStatusChange:t}=e,l=o[s.status],a=x[s.priority||"medium"];return(0,r.jsxs)("div",{className:"bg-white shadow-lg rounded-2xl border border-slate-200 hover:shadow-xl transition-all duration-300 overflow-hidden",children:[(0,r.jsx)("div",{className:"h-2 ".concat("blue"===l.color?"bg-blue-500":"green"===l.color?"bg-green-500":"bg-yellow-500")}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-slate-800",children:s.title}),s.priority&&(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(a.bg," ").concat(a.color),children:a.label})]}),(0,r.jsx)("p",{className:"text-slate-600 text-sm mb-3",children:s.description})]}),(0,r.jsx)(c.A,{status:l.label,variant:l.variant})]}),(0,r.jsxs)("div",{className:"space-y-3 mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[(0,r.jsx)(d.w_X,{className:"w-4 h-4"}),(0,r.jsxs)("span",{children:["Создано: ",(e=>e?new Date(e).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}):"Не указано")(s.createdAt||Date.now())]})]}),s.assignedBy&&(0,r.jsxs)("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[(0,r.jsx)(d.x$1,{className:"w-4 h-4"}),(0,r.jsxs)("span",{children:["Назначил: ",s.assignedBy]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[(0,r.jsx)(d.$Fg,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Маршрут: Автоматически построен"})]})]}),t&&"completed"!==s.status&&(0,r.jsx)("div",{className:"pt-4 border-t border-slate-200",children:(0,r.jsxs)("div",{className:"flex gap-2",children:["pending"===s.status&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>t("in_progress"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold transition-all duration-200 hover:shadow-lg",children:[(0,r.jsx)(d.$Fg,{className:"w-4 h-4"}),"Начать выполнение"]}),(0,r.jsx)("button",{className:"px-4 py-3 bg-gray-100 hover:bg-gray-200 text-gray-600 rounded-xl transition-colors",children:(0,r.jsx)(d.vq8,{className:"w-4 h-4"})})]}),"in_progress"===s.status&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>t("completed"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-green-600 hover:bg-green-700 text-white rounded-xl font-semibold transition-all duration-200 hover:shadow-lg",children:[(0,r.jsx)(d.O5k,{className:"w-4 h-4"}),"Завершить задачу"]}),(0,r.jsx)("button",{className:"px-4 py-3 bg-blue-100 hover:bg-blue-200 text-blue-600 rounded-xl transition-colors",children:(0,r.jsx)(d.vq8,{className:"w-4 h-4"})})]})]})}),"completed"===s.status&&(0,r.jsx)("div",{className:"pt-4 border-t border-slate-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2 py-2 text-green-600",children:[(0,r.jsx)(d.O5k,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"Задача выполнена"})]})})]})]})},u=()=>{let e=[{id:"1",title:"Первая поездка",description:"Выполните свою первую задачу",icon:(0,r.jsx)(d.gt3,{className:"w-5 h-5"}),earned:!0,color:"bg-yellow-500"},{id:"2",title:"Скоростной водитель",description:"Выполните 10 задач за день",icon:(0,r.jsx)(d.Itl,{className:"w-5 h-5"}),earned:!1,progress:3,maxProgress:10,color:"bg-red-500"},{id:"3",title:"Мастер времени",description:"Выполните задачу досрочно 5 раз",icon:(0,r.jsx)(d.w_X,{className:"w-5 h-5"}),earned:!1,progress:2,maxProgress:5,color:"bg-blue-500"},{id:"4",title:"Дальнобойщик",description:"Проедьте 1000 км",icon:(0,r.jsx)(d.$Fg,{className:"w-5 h-5"}),earned:!1,progress:245,maxProgress:1e3,color:"bg-green-500"},{id:"5",title:"Профессионал",description:"Получите рейтинг 4.8+",icon:(0,r.jsx)(d.SBv,{className:"w-5 h-5"}),earned:!0,color:"bg-purple-500"},{id:"6",title:"Надежный партнер",description:"Выполните 100 задач",icon:(0,r.jsx)(d.tz0,{className:"w-5 h-5"}),earned:!1,progress:47,maxProgress:100,color:"bg-orange-500"}];return(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Достижения"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(d.SBv,{className:"w-5 h-5 text-yellow-500"}),(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-600",children:[e.filter(e=>e.earned).length,"/",e.length]})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-4",children:e.map(e=>(0,r.jsxs)("div",{className:"relative p-4 rounded-xl border-2 transition-all duration-200 ".concat(e.earned?"border-yellow-200 bg-gradient-to-br from-yellow-50 to-orange-50 shadow-md":"border-gray-200 bg-gray-50 hover:bg-gray-100"),children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"p-2 rounded-lg ".concat(e.color," ").concat(e.earned?"text-white":"text-white opacity-50"),children:e.icon}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("h4",{className:"font-semibold text-sm ".concat(e.earned?"text-gray-900":"text-gray-600"),children:e.title}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:e.description}),!e.earned&&void 0!==e.progress&&e.maxProgress&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[(0,r.jsx)("span",{children:e.progress}),(0,r.jsx)("span",{children:e.maxProgress})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,r.jsx)("div",{className:"h-1.5 rounded-full ".concat(e.color),style:{width:"".concat(e.progress/e.maxProgress*100,"%")}})})]})]})]}),e.earned&&(0,r.jsx)("div",{className:"absolute -top-1 -right-1 w-6 h-6 bg-yellow-500 rounded-full flex items-center justify-center",children:(0,r.jsx)(d.gt3,{className:"w-3 h-3 text-white"})})]},e.id))})]})},g=()=>{let[e,s]=(0,l.useState)([{id:"1",type:"task_completed",message:'Задача "Доставка посылки #123" выполнена',timestamp:new Date(Date.now()-3e5),icon:(0,r.jsx)(d.A7C,{className:"w-4 h-4"}),color:"text-green-600"},{id:"2",type:"location_update",message:"Местоположение обновлено",timestamp:new Date(Date.now()-6e5),icon:(0,r.jsx)(d.vq8,{className:"w-4 h-4"}),color:"text-blue-600"},{id:"3",type:"task_started",message:'Начато выполнение задачи "Забрать груз"',timestamp:new Date(Date.now()-15e5),icon:(0,r.jsx)(d.$Fg,{className:"w-4 h-4"}),color:"text-purple-600"},{id:"4",type:"notification",message:"Новое уведомление от диспетчера",timestamp:new Date(Date.now()-27e5),icon:(0,r.jsx)(d.jNV,{className:"w-4 h-4"}),color:"text-orange-600"}]);return(0,l.useEffect)(()=>{let e=setInterval(()=>{let e={id:Date.now().toString(),type:"location_update",message:"Местоположение обновлено",timestamp:new Date,icon:(0,r.jsx)(d.vq8,{className:"w-4 h-4"}),color:"text-blue-600"};s(s=>[e,...s.slice(0,9)])},3e4);return()=>clearInterval(e)},[]),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Активность"}),(0,r.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"})]}),(0,r.jsx)("div",{className:"space-y-4 max-h-80 overflow-y-auto",children:e.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-start gap-3 group",children:[(0,r.jsx)("div",{className:"p-2 rounded-lg bg-gray-50 group-hover:bg-gray-100 transition-colors ".concat(e.color),children:e.icon}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm text-gray-900 group-hover:text-gray-700 transition-colors",children:e.message}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,r.jsx)(d.w_X,{className:"w-3 h-3 text-gray-400"}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:(e=>{let s=Math.floor((new Date().getTime()-e.getTime())/6e4);if(s<1)return"Только что";if(s<60)return"".concat(s," мин назад");let t=Math.floor(s/60);return t<24?"".concat(t," ч назад"):e.toLocaleDateString("ru-RU")})(e.timestamp)})]})]}),0===s&&(0,r.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"})]},e.id))}),(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-100",children:(0,r.jsx)("button",{className:"w-full text-sm text-blue-600 hover:text-blue-700 font-medium transition-colors",children:"Показать всю историю"})})]})},h=()=>{let[e,s]=(0,l.useState)({temperature:15,condition:"cloudy",humidity:65,windSpeed:12,visibility:8,roadCondition:"good"}),t={sunny:(0,r.jsx)(d.wQq,{className:"w-8 h-8 text-yellow-500"}),cloudy:(0,r.jsx)(d.tmj,{className:"w-8 h-8 text-gray-500"}),rainy:(0,r.jsx)(d.bk_,{className:"w-8 h-8 text-blue-500"}),snowy:(0,r.jsx)(d.YhS,{className:"w-8 h-8 text-blue-300"})};(0,l.useEffect)(()=>{let e=setInterval(()=>{s(e=>({...e,temperature:e.temperature+(Math.random()-.5)*2,windSpeed:Math.max(0,e.windSpeed+(Math.random()-.5)*3)}))},6e4);return()=>clearInterval(e)},[]);let a={good:{label:"Хорошие",color:"text-green-600",bg:"bg-green-100"},wet:{label:"Мокрые",color:"text-blue-600",bg:"bg-blue-100"},icy:{label:"Гололед",color:"text-red-600",bg:"bg-red-100"},poor:{label:"Плохие",color:"text-orange-600",bg:"bg-orange-100"}}[e.roadCondition];return(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Погода и дороги"}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"Обновлено: сейчас"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[t[e.condition],(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:[Math.round(e.temperature),"\xb0C"]}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:{sunny:"Солнечно",cloudy:"Облачно",rainy:"Дождь",snowy:"Снег"}[e.condition]})]})]}),(0,r.jsxs)("div",{className:"px-3 py-2 rounded-lg ".concat(a.bg),children:[(0,r.jsx)("div",{className:"text-xs text-gray-600",children:"Дороги"}),(0,r.jsx)("div",{className:"text-sm font-medium ".concat(a.color),children:a.label})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-xl",children:[(0,r.jsx)(d.YiW,{className:"w-4 h-4 text-blue-500"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"Ветер"}),(0,r.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[Math.round(e.windSpeed)," км/ч"]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-xl",children:[(0,r.jsx)(d.R_2,{className:"w-4 h-4 text-red-500"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"Влажность"}),(0,r.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.humidity,"%"]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-xl col-span-2",children:[(0,r.jsx)(d.Ny1,{className:"w-4 h-4 text-purple-500"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"Видимость"}),(0,r.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.visibility," км"]})]})]})]}),("rainy"===e.condition||"icy"===e.roadCondition)&&(0,r.jsxs)("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-xl",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),(0,r.jsx)("span",{className:"text-sm font-medium text-yellow-800",children:"Осторожно на дороге!"})]}),(0,r.jsxs)("p",{className:"text-xs text-yellow-700 mt-1",children:["rainy"===e.condition&&"Дождь может ухудшить видимость","icy"===e.roadCondition&&"Возможен гололед"]})]})]})},j=e=>{let{tasks:s}=e,t=s.length,l=s.filter(e=>"completed"===e.status).length,a=s.filter(e=>"in_progress"===e.status).length,i=s.filter(e=>"pending"===e.status).length,n=t>0?l/t*100:0;return(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Прогресс выполнения"}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(n),"%"]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[(0,r.jsx)("span",{children:"Выполнено задач"}),(0,r.jsxs)("span",{children:[l," из ",t]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:(0,r.jsx)("div",{className:"h-full bg-gradient-to-r from-blue-500 to-green-500 rounded-full transition-all duration-500 ease-out",style:{width:"".concat(n,"%")}})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"text-center p-3 bg-green-50 rounded-xl",children:[(0,r.jsx)("div",{className:"flex justify-center mb-2",children:(0,r.jsx)(d.A7C,{className:"w-5 h-5 text-green-600"})}),(0,r.jsx)("div",{className:"text-lg font-bold text-green-900",children:l}),(0,r.jsx)("div",{className:"text-xs text-green-600",children:"Завершено"})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-blue-50 rounded-xl",children:[(0,r.jsx)("div",{className:"flex justify-center mb-2",children:(0,r.jsx)(d.lhZ,{className:"w-5 h-5 text-blue-600"})}),(0,r.jsx)("div",{className:"text-lg font-bold text-blue-900",children:a}),(0,r.jsx)("div",{className:"text-xs text-blue-600",children:"В работе"})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-yellow-50 rounded-xl",children:[(0,r.jsx)("div",{className:"flex justify-center mb-2",children:(0,r.jsx)(d.w_X,{className:"w-5 h-5 text-yellow-600"})}),(0,r.jsx)("div",{className:"text-lg font-bold text-yellow-900",children:i}),(0,r.jsx)("div",{className:"text-xs text-yellow-600",children:"Ожидают"})]})]}),t>0&&(0,r.jsx)("div",{className:"mt-4 p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl",children:(0,r.jsx)("div",{className:"text-sm text-center",children:100===n?(0,r.jsx)("span",{className:"text-green-700 font-medium",children:"\uD83C\uDF89 Отличная работа! Все задачи выполнены!"}):n>=75?(0,r.jsx)("span",{className:"text-blue-700 font-medium",children:"\uD83D\uDCAA Почти готово! Осталось совсем немного!"}):n>=50?(0,r.jsx)("span",{className:"text-purple-700 font-medium",children:"⚡ Хорошая работа! Продолжайте в том же духе!"}):(0,r.jsx)("span",{className:"text-gray-700 font-medium",children:"\uD83D\uDE80 Начинаем день! Удачи в выполнении задач!"})})})]})};var p=t(983),b=t(926);let f=(0,b.createServerReference)("60825c8ccfb0d4116147c158d30b42e0ba9d5177ed",b.callServer,void 0,b.findSourceMapURL,"updateTaskStatus");function v(){var e,s,t;let{auth:c,firestore:o}=(0,a.D)(),[x,b]=(0,l.useState)([]),[v,N]=(0,l.useState)(!0),[y,w]=(0,l.useState)(!1),[k,S]=(0,l.useState)([{id:1,message:"Новая задача назначена",time:"5 мин назад",type:"info"},{id:2,message:"Маршрут обновлен",time:"15 мин назад",type:"success"}]),[D,O]=(0,l.useState)({totalDistance:245,workingHours:8.5,rating:4.8,completedToday:3,fuelEfficiency:12.5});(0,l.useEffect)(()=>{if(!(null==c?void 0:c.currentUser)){v&&N(!1);return}N(!0);let e=c.currentUser.uid,s=(0,i.P)((0,i.rJ)(o,"tasks"),(0,i._M)("assignedTo","==",e)),t=(0,i.aQ)(s,e=>{let s=[];e.forEach(e=>{s.push({id:e.id,...e.data()})}),s.sort((e,s)=>"completed"===e.status&&"completed"!==s.status?1:"completed"!==e.status&&"completed"===s.status?-1:0),b(s),N(!1)},e=>{console.error("Error fetching tasks: ",e),N(!1)});return()=>t()},[c,o,v]);let P=async(e,s)=>{await f(e,s),b(t=>t.map(t=>t.id===e?{...t,status:s}:t))};return(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-purple-50",children:(0,r.jsxs)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between mb-8 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Панель водителя"}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,r.jsxs)("span",{children:["Добро пожаловать, ",null==c||null==(s=c.currentUser)||null==(e=s.email)?void 0:e.split("@")[0]]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(d.gt3,{className:"w-4 h-4 text-yellow-500"}),(0,r.jsx)("span",{className:"font-medium",children:D.rating})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(d.Z0L,{className:"w-4 h-4 text-blue-500"}),(0,r.jsx)("span",{children:"Уровень: Профи"})]}),y&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),(0,r.jsx)("span",{className:"text-green-600 font-medium",children:"В смене"})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("button",{className:"flex items-center gap-2 px-6 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-200 transform hover:-translate-y-0.5 ".concat(y?"bg-red-600 hover:bg-red-700 text-white":"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white"),onClick:()=>w(e=>!e),children:[y?(0,r.jsx)(d.w_X,{className:"w-5 h-5"}):(0,r.jsx)(d.$Fg,{className:"w-5 h-5"}),y?"Завершить смену":"Начать смену"]}),(0,r.jsxs)("button",{className:"relative p-3 bg-white text-gray-600 hover:text-blue-600 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200",children:[(0,r.jsx)(d.jNV,{className:"w-5 h-5"}),k.length>0&&(0,r.jsx)("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:k.length})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-6",children:[(0,r.jsx)(p.A,{title:"Пройдено сегодня",value:"".concat(D.totalDistance," км"),icon:(0,r.jsx)(d.$Fg,{className:"w-6 h-6"}),color:"blue",description:"Общий пробег за смену"}),(0,r.jsx)(p.A,{title:"Время в пути",value:"".concat(D.workingHours," ч"),icon:(0,r.jsx)(d.w_X,{className:"w-6 h-6"}),color:"purple",description:"Активное время работы"}),(0,r.jsx)(p.A,{title:"Выполнено задач",value:D.completedToday,icon:(0,r.jsx)(d.A7C,{className:"w-6 h-6"}),color:"green",description:"Завершено за сегодня"}),(0,r.jsx)(p.A,{title:"Расход топлива",value:"".concat(D.fuelEfficiency," л/100км"),icon:(0,r.jsx)(d.dD7,{className:"w-6 h-6"}),color:"orange",description:"Средний расход"}),(0,r.jsx)(p.A,{title:"Рейтинг",value:D.rating,icon:(0,r.jsx)(d.gt3,{className:"w-6 h-6"}),color:"red",description:"Оценка клиентов"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,r.jsxs)("div",{className:"lg:col-span-2",children:[(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden mb-6",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-100",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Активные задачи"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1 bg-blue-50 rounded-lg",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,r.jsxs)("span",{className:"text-sm text-blue-700 font-medium",children:[x.filter(e=>"in_progress"===e.status).length," в работе"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1 bg-yellow-50 rounded-lg",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),(0,r.jsxs)("span",{className:"text-sm text-yellow-700 font-medium",children:[x.filter(e=>"pending"===e.status).length," ожидают"]})]})]})]})}),(0,r.jsx)("div",{className:"p-6",children:v?(0,r.jsx)(()=>(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[void 0,void 0,void 0].map((e,s)=>(0,r.jsxs)("div",{className:"bg-white shadow-lg rounded-xl p-6 border border-slate-200 animate-pulse",children:[(0,r.jsx)("div",{className:"h-6 bg-slate-200 rounded w-3/4 mb-4"}),(0,r.jsx)("div",{className:"h-4 bg-slate-200 rounded w-full mb-2"}),(0,r.jsx)("div",{className:"h-4 bg-slate-200 rounded w-5/6"}),(0,r.jsx)("div",{className:"mt-6 pt-4 border-t border-slate-200",children:(0,r.jsx)("div",{className:"h-10 bg-slate-200 rounded w-full"})})]},s))}),{}):x.length>0?(0,r.jsx)("div",{className:"space-y-4",children:x.map(e=>(0,r.jsx)("div",{className:"transform hover:scale-[1.01] transition-transform duration-200",children:(0,r.jsx)(m,{task:e,onStatusChange:s=>P(e.id,s)})},e.id))}):(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-blue-100 to-purple-100 rounded-full flex items-center justify-center",children:(0,r.jsx)(d.dv1,{className:"w-8 h-8 text-blue-600"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Нет назначенных задач"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Отдыхайте! Как только появится новая задача, вы увидите ее здесь."})]})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden mb-6",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-100",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center",children:(0,r.jsx)(d.vq8,{className:"w-5 h-5 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Отслеживание маршрута"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:y?"Активное отслеживание местоположения":"Отслеживание приостановлено"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(y?"bg-green-500 animate-pulse":"bg-gray-400")}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-600",children:y?"Онлайн":"Офлайн"})]})]})}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl p-6 min-h-[300px] flex items-center justify-center",children:(0,r.jsx)(n,{active:y,routeId:(null==c||null==(t=c.currentUser)?void 0:t.uid)||null})})})]}),(0,r.jsx)(g,{})]}),(0,r.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Уведомления"}),(0,r.jsx)(d.jNV,{className:"w-5 h-5 text-gray-400"})]}),(0,r.jsx)("div",{className:"space-y-3",children:k.map(e=>(0,r.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors",children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full mt-2 ".concat("info"===e.type?"bg-blue-500":"bg-green-500")}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm text-gray-900",children:e.message}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.time})]})]},e.id))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Быстрые действия"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left bg-blue-50 hover:bg-blue-100 rounded-xl transition-colors",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:(0,r.jsx)(d.uN,{className:"w-4 h-4 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:"Чат с диспетчером"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Связаться с офисом"})]})]}),(0,r.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left bg-green-50 hover:bg-green-100 rounded-xl transition-colors",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-green-500 rounded-lg flex items-center justify-center",children:(0,r.jsx)(d.vq8,{className:"w-4 h-4 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:"Экстренная помощь"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Вызвать службу поддержки"})]})]}),(0,r.jsxs)("button",{className:"w-full flex items-center gap-3 p-3 text-left bg-purple-50 hover:bg-purple-100 rounded-xl transition-colors",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-purple-500 rounded-lg flex items-center justify-center",children:(0,r.jsx)(d.$BV,{className:"w-4 h-4 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:"Отчет о поездке"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Просмотр статистики"})]})]})]})]}),(0,r.jsx)(j,{tasks:x}),(0,r.jsx)(u,{}),(0,r.jsx)(h,{})]})]})]})})}},4585:(e,s,t)=>{t.d(s,{BV:()=>o,j2:()=>c,kA:()=>d,yA:()=>n});var r=t(2078),l=t(2553),a=t(9708),i=t(1446);let n=(0,r.Dk)().length?(0,r.Sx)():(0,r.Wp)({apiKey:"AIzaSyBTdkRQUoEWJFTXNP5vGD8_DYZjLcyDpog",authDomain:"autopark-system.firebaseapp.com",projectId:"autopark-system",storageBucket:"autopark-system.firebasestorage.app",messagingSenderId:"375110425620",appId:"1:375110425620:web:0f357c1d44927b0d219b01",measurementId:"G-2VV3093XBH"}),c=(0,l.xI)(n),d=(0,a.aU)(n),o=(0,i.dG)(n)},6724:(e,s,t)=>{t.d(s,{k5:()=>o});var r=t(2115),l={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},a=r.createContext&&r.createContext(l),i=["attr","size","title"];function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}function c(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);s&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),t.push.apply(t,r)}return t}function d(e){for(var s=1;s<arguments.length;s++){var t=null!=arguments[s]?arguments[s]:{};s%2?c(Object(t),!0).forEach(function(s){var r,l,a;r=e,l=s,a=t[s],(l=function(e){var s=function(e,s){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,s||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(e)}(e,"string");return"symbol"==typeof s?s:s+""}(l))in r?Object.defineProperty(r,l,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[l]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))})}return e}function o(e){return s=>r.createElement(x,n({attr:d({},e.attr)},s),function e(s){return s&&s.map((s,t)=>r.createElement(s.tag,d({key:t},s.attr),e(s.child)))}(e.child))}function x(e){var s=s=>{var t,{attr:l,size:a,title:c}=e,o=function(e,s){if(null==e)return{};var t,r,l=function(e,s){if(null==e)return{};var t={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(s.indexOf(r)>=0)continue;t[r]=e[r]}return t}(e,s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],!(s.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}(e,i),x=a||s.size||"1em";return s.className&&(t=s.className),e.className&&(t=(t?t+" ":"")+e.className),r.createElement("svg",n({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,l,o,{className:t,style:d(d({color:e.color||s.color},s.style),e.style),height:x,width:x,xmlns:"http://www.w3.org/2000/svg"}),c&&r.createElement("title",null,c),e.children)};return void 0!==a?r.createElement(a.Consumer,null,e=>s(e)):s(l)}},9934:(e,s,t)=>{t.d(s,{D:()=>c,R:()=>n});var r=t(5155),l=t(2115),a=t(4585);let i=(0,l.createContext)(null),n=e=>{let{children:s}=e;return(0,r.jsx)(i.Provider,{value:{app:a.yA,auth:a.j2,firestore:a.kA,messaging:a.BV},children:s})},c=()=>{let e=(0,l.useContext)(i);if(!e)throw Error("useFirebase must be used within a FirebaseProvider");return e}}}]);